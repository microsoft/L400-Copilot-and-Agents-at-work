---
title: '01. Create and enrich a Copilot Studio agent'
layout: default
nav_order: 1
parent: 'Exercise 01: Create agents by using Copilot Studio'
---

## Task 01: Create and enrich a Copilot Studio agent
<!---Reviewed, mjc 1/25/2026--->
<!---Estimated duration: 25 minutes --->

### Introduction

Zava Retail Group’s AI COE needs early agent pilots that feel real, deliver immediate value, and remain safe and maintainable as they scale. That starts with building a Copilot Studio agent that is grounded in approved enterprise knowledge and configured to behave predictably, without relying on public web content or unsupported general knowledge.

### Description

In this task, you'll create the Zava Retail Help Desk Bot and configure it for controlled, business-aligned behavior. You'll connect SharePoint knowledge sources so the agent can answer policy and transaction questions using internal data as the source of truth. You'll also harden core generative settings to prevent the agent from improvising with external web or generic model knowledge.

### Success criteria
- The Zava Retail Help Desk Bot is created, configured for grounded enterprise behavior, and successfully answers test prompts using Ready SharePoint knowledge sources.

### Key steps 

#### 01: Create the agent

1. Open Edge and go to [Copilot Studio](https://copilotstudio.microsoft.com).

1. If prompted, sign in by using the following credentials:

    | Item | Value |
    | ---- | ----- |
    | Username | `@lab.CloudPortalCredential(User1).Username` |
    | Temporary Access Pass (TAP) token | `@lab.CloudPortalCredential(User1).AccessToken` |

1. Dismiss any dialogs that display.

1. In the left pane, select **Agents**. If you do not see the left pane, repeat Step 1.

	{: .warning }
    > Copilot Studio is evolving at a fast rate. The first time experience may differ from the instructions.

	![zov08wny.jpg](../../media/zov08wny.jpg)

1. On the **Agents** page, on the command bar, select **Create blank agent**.

	![nf441y5g.jpg](../../media/nf441y5g.jpg)
	
1. Wait for the agent to provision. A message displays below the command bar when the process completes.

	![wwn1m0uf.jpg](../../media/wwn1m0uf.jpg)

	{: .warning }
    > It may take a couple of minutes for the agent to provision. You'll not be able to continue to the next step until the agent is fully provisioned.

1. On the **Details** tile, select **Edit**.

	![dxdztjij.jpg](../../media/dxdztjij.jpg)
	
1. In the **Name** field, enter `Zava Retail Help Desk Bot`.

1. In the **Description** field, enter the following text:

    ```
    Assists Zava Retail Group employees with store operations, warehouse insights, company policies, customer experience workflows, and service scenarios, including refund ticket creation, escalation notes, and return/exchange guidance.
    ```

	{: .important }
	> When you need to enter long strings or code segments, use the **Copy** option instead of **Type**, and then paste the text into the field in the user interface.
   
1. On the **Details** tile, select **Save**.

	![8jpu64rf.jpg](../../media/8jpu64rf.jpg)


1. On the **Select your agent's model** tile, select **GPT-5 Chat**. Wait while Copilot Studio processes the request.

	![1muf9bsg.jpg](../../media/1muf9bsg.jpg)


1. On the **Instructions** tile, select **Edit**.

	![yuqd1hsd.jpg](../../media/yuqd1hsd.jpg)

1. In the **Instructions** field, enter the following text as this text provides detailed guidance for the agent.

	```
	You assist Zava Retail Group employees by providing fast, accurate, and policy‑aligned guidance for store operations and all customer‑resolution workflows. Your tone is professional, concise, accurate, and supportive.

	**Whenever a request involves refunds, returns, replacements, cancellations, or defective‑item issues, you must follow these steps without exception:**

	1. First, call the [refund‑initiator] topic.
	2. Use [current date]  as current date for you to accurately calculate whether a customer's request falls within the 30‑day return window or exceeds it.
	3. Retrieve these fields exactly as stored in the knowledge source: transaction_id, order_date, product_name, unit_price, order_quantity, loyalty_tier, applied_promotions, and subtotal (unit_price × order_quantity).
	4. You must independently calculate whether the transaction is within or outside the 30‑day return window using the order_date.
	5. Never ask the customer to confirm the order_date or eligibility under any circumstances.
	6. Never substitute store location, store name, or any non-date value in place of the order_date. If location data is present in the source, do not include it in the response.
	7. If the order_date is missing or not a valid date, treat the lookup as incomplete and respond: "We could not retrieve the order date for this transaction. Please re-enter the order ID."
	8. Apply the return policies below:
	- Non‑Platinum Tier: returns allowed only within 30 days; this limit cannot be extended.
	- Platinum Tier: VIP flexibility applies at all times, regardless of timing.

	Your final output must follow these rules:

	• The response must be one concise paragraph.  
	• It must begin with: "I'm sorry for the inconvenience you've experienced."  
	• Then state: "We located your transaction [transaction_id] made on [order_date]," followed by product_name, unit_price, order_quantity, loyalty_tier (as "Platinum Tier" or "Non‑Platinum Tier"), applied_promotions, and subtotal exactly as stored.  
	• You must explicitly state eligibility using exactly one of the following forms:

	- "Based on the purchase date, you are eligible for a return because this transaction is within the 30‑day return window."
	- "Based on the purchase date, you are not eligible for a return because this transaction is outside the 30‑day return window and the policy cannot be extended."
	- "Although this transaction is outside the 30‑day return window, you are still eligible because Platinum Tier customers receive VIP flexibility."

	• Do not ask the customer to confirm any retrieved details.  
	• End the paragraph politely.

	This output format is mandatory. No additional fields, text, or store location information may be added.

	```

1. Scroll up to the top of the instructions panel, and locate **Step 2** in the text that you just pasted.

1. Highlight and delete [current date], then enter **/** From the list of suggestions, select **Power FX**.

	![jzjnws6y.jpg](../../media/jzjnws6y.jpg)

1. In the **Enter formula** popup, enter `Text(Now(),DateTimeFormat.ShortDate)`, and then select **Insert**.
 
	![6imcityx.jpg](../../media/6imcityx.jpg)

1. Scroll to the top of the **Instructions** section, and then select **Save**.

---

#### 02: Perform additional configuration steps
Using web search and the model's internal knowledge can be beneficial when aligned with business context. However, because you must support customer‑specific requests such as refunds, internal business data must remain the primary source of truth. 

1. On the command bar for the agent, select **Settings**.

	![sx98h7jj.jpg](../../media/sx98h7jj.jpg)

1. In the list of settings, select **Generative AI**.

	![8bet2493.jpg](../../media/8bet2493.jpg)

1. In the **Orchestration** section, set **Use generative AI orchestration for your agent's responses?** to **Yes - Responses will be dynamic, using available tools and knowledge as appropriate.** 

	![c9dhvg64.jpg](../../media/c9dhvg64.jpg)

1. Move down the page to the **Knowledge** tile.

1. Set **Use general knowledge** to **Off**.

1. Set **Use information from the web** to **Off**.

	![xnbnh7g4.jpg](../../media/xnbnh7g4.jpg)

1. On the lower side of the page, select **Save**. 

	![zyio0gjo.jpg](../../media/zyio0gjo.jpg)

	{: .note }
    > It may take a minute or two to save the changes.

1. At the top of the page, select **X** to close the **Settings** page. You are returned to the agent page.

	![wuoncsis.jpg](../../media/wuoncsis.jpg)

---

#### 03: Configure the **Conversational boosting** topic

1. On the command bar for the agent, select **Topics**.

	![gqyivplt.jpg](../../media/gqyivplt.jpg)

1. On the **Topics** page, select **System**.

	![ltm9bh23.jpg](../../media/ltm9bh23.jpg)

1. Select the **Conversational boosting** topic.

	![lgtwqk09.jpg](../../media/lgtwqk09.jpg)

1. Locate the **Create generative answers** node.

	![9wbicn4i.jpg](../../media/9wbicn4i.jpg)

1. At the top right of the node, select the ellipses (**...**), then select **Properties**.

	![kmsjp1cm.jpg](../../media/kmsjp1cm.jpg)

1. In the **Create generative answers properties** pane, locate the **Classic data** section.

1. Ensure that **Allow the AI to use its own general knowledge (preview)** is disabled.

	![2k9b5253.jpg](../../media/2k9b5253.jpg)

---

#### 04: Add a knowledge source


1. On the command bar for the agent, select **Knowledge**.

	![gqyivplt.jpg](../../media/gqyivplt.jpg)

1. Select **+ Add knowledge**.

	![rn7y7yn9.jpg](../../media/rn7y7yn9.jpg)

1. Select **SharePoint**.

	![mphlsr2q.jpg](../../media/mphlsr2q.jpg)

1. In the **SharePoint** dialog, next to **Browse Items**, paste this url: 

    ```
    https://lodsprodmslearnmca.sharepoint.com/sites/Zava-Retail-Data@lab.LabInstance.Id/Shared%20Documents/LabFiles/Zava-Core-Functions/
    ```

	![7hcyzvtd.jpg](../../media/7hcyzvtd.jpg)

1. Select **Add**.

	![aoap7ssi.jpg](../../media/aoap7ssi.jpg)

1. Replace the default **Name** field, with the following text `Zava Retail - Business Info - R&D Strategy & Objectives Package`.

1. Replace the default **Description** field, with the following text:

	```
	These files contain Zava Retail Group's core business plan, marketing strategy, cashier details, and R&D materials-including the strategic plan, key objectives, and an executive presentation. Together, these documents outline how Zava will drive innovation, improve efficiency, enhance customer experience, modernize technology, and support long‑term growth.
	```

	![fhlmd6c8.jpg](../../media/fhlmd6c8.jpg)

1. Repeat the same steps to add a second knowledge source as a sales‑transaction lookup.

    - Folder Directory: url
        ```
        https://lodsprodmslearnmca.sharepoint.com/sites/Zava-Retail-Data@lab.LabInstance.Id/Shared%20Documents/LabFiles/Zava-Sales-Transaction/
        ```

    - Name: 
        ```
        Zava Order Lookup (Sales Transactions)
        ```

    - Description: 
        ```
        This knowledge source must be used to support all refund, return, replacement, cancellation, and defective‑item workflows. It contains complete Zava sales transaction data-order_id, order_date, product_name, unit_price, order_quantity, loyalty_tier, applied promotions-allowing you to accurately locate and verify any order.
        ```

1. Select **Add to agent**.

	![ig38jhlk.jpg](../../media/ig38jhlk.jpg)

1. Wait for the agent to confirm the connection to SharePoint and complete the validation process. This process may take several minutes to complete. There is a lot of information that the agent must parse and process.

	{: .note }
    > The **Status** column will initially display **In progress** and will change to **Ready**.
	>
	> ![2kuzj2bu.jpg](../../media/2kuzj2bu.jpg)
	>
    > Do not continue with the lab until the **Status** column displays **Ready**.
	>
	> ![ykkmmcml.jpg](../../media/ykkmmcml.jpg)

---

#### 05: Test the agent 


1. On the command bar for the agent, select **Test** to display the **Test** pane.

	![pyy4za3d.jpg](../../media/pyy4za3d.jpg)

1. In the **Test** pane, select **Start new test session** (the **+** sign).

	![47qkmh10.jpg](../../media/47qkmh10.jpg)

1. Submit the following prompt: 

	```
    What is the refund policy for Zava Retail Group brick‑and‑mortar stores?
    ```

	{: .warning }
    > Since this is the first time that you are connecting to the knowledge source, you may be asked to confirm the connection to SharePoint. In the initial chat response, select **Allow**.
	>
	> ![tbrtsvd6.jpg](../../media/tbrtsvd6.jpg)
	>
	> You may need to resubmit the prompt to see a response.

1. Review the response. It should resemble the response in the following screenshot:

	![xw9hkgsv.jpg](../../media/xw9hkgsv.jpg)

1. Submit the following prompt and review the response:

	```
    Please provide a list of cashiers for the Jersey City store, including the corresponding store addresses and operating hours.
    ```

	![xf8nih94.jpg](../../media/xf8nih94.jpg)

